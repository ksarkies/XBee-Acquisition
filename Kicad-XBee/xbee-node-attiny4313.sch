EESchema Schematic File Version 2
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:special
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:RF_OEM_Parts
LIBS:KB1LQC
LIBS:xbee-node-attiny4313-cache
EELAYER 24 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 1 1
Title "XBee ATTiny4313 Counting Node"
Date "26 Jul 2014"
Rev "0.0"
Comp "K. Sarkies"
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Comp
L ATTINY4313-S U1
U 1 1 53CEECF3
P 3100 3500
F 0 "U1" H 1950 4500 40  0000 C CNN
F 1 "ATTINY4313-S" H 4050 2600 40  0000 C CNN
F 2 "SO20" H 3100 3500 35  0000 C CIN
F 3 "" H 3100 3500 60  0000 C CNN
	1    3100 3500
	1    0    0    -1  
$EndComp
$Comp
L XBEE XB1
U 1 1 53D329A6
P 7800 2950
F 0 "XB1" H 7800 3750 60  0000 C CNN
F 1 "XBEE" H 7800 3850 60  0000 C CNN
F 2 "" H 7800 2950 60  0000 C CNN
F 3 "" H 7800 2950 60  0000 C CNN
	1    7800 2950
	1    0    0    -1  
$EndComp
$Comp
L CONN_2 P4
U 1 1 53D32A7E
P 10400 1500
F 0 "P4" V 10350 1500 40  0000 C CNN
F 1 "Battery" V 10450 1500 40  0000 C CNN
F 2 "" H 10400 1500 60  0000 C CNN
F 3 "" H 10400 1500 60  0000 C CNN
	1    10400 1500
	1    0    0    -1  
$EndComp
$Comp
L MOSFET_N Q3
U 1 1 53D32AE5
P 9550 2700
F 0 "Q3" H 9900 2750 60  0000 R CNN
F 1 "2N7000" H 10100 2650 60  0000 R CNN
F 2 "" H 9550 2700 60  0000 C CNN
F 3 "" H 9550 2700 60  0000 C CNN
	1    9550 2700
	1    0    0    -1  
$EndComp
$Comp
L R R7
U 1 1 53D32AFA
P 9650 2250
F 0 "R7" V 9730 2250 40  0000 C CNN
F 1 "15K" V 9657 2251 40  0000 C CNN
F 2 "" V 9580 2250 30  0000 C CNN
F 3 "" H 9650 2250 30  0000 C CNN
	1    9650 2250
	1    0    0    -1  
$EndComp
$Comp
L R R8
U 1 1 53D32B0E
P 9650 3150
F 0 "R8" V 9730 3150 40  0000 C CNN
F 1 "4.7K" V 9657 3151 40  0000 C CNN
F 2 "" V 9580 3150 30  0000 C CNN
F 3 "" H 9650 3150 30  0000 C CNN
	1    9650 3150
	1    0    0    -1  
$EndComp
$Comp
L R R6
U 1 1 53D32B68
P 4550 1700
F 0 "R6" V 4630 1700 40  0000 C CNN
F 1 "10K" V 4557 1701 40  0000 C CNN
F 2 "" V 4480 1700 30  0000 C CNN
F 3 "" H 4550 1700 30  0000 C CNN
	1    4550 1700
	-1   0    0    1   
$EndComp
$Comp
L R R3
U 1 1 53D32BAE
P 3150 5250
F 0 "R3" V 3230 5250 40  0000 C CNN
F 1 "120K" V 3157 5251 40  0000 C CNN
F 2 "" V 3080 5250 30  0000 C CNN
F 3 "" H 3150 5250 30  0000 C CNN
	1    3150 5250
	1    0    0    -1  
$EndComp
$Comp
L CSMALL C1
U 1 1 53D32BD6
P 4550 2050
F 0 "C1" H 4575 2100 30  0000 L CNN
F 1 "0.1uF" H 4575 2000 30  0000 L CNN
F 2 "" H 4550 2050 60  0000 C CNN
F 3 "" H 4550 2050 60  0000 C CNN
	1    4550 2050
	1    0    0    -1  
$EndComp
$Comp
L CP C3
U 1 1 53D32BEA
P 6150 1750
F 0 "C3" H 6200 1850 40  0000 L CNN
F 1 "10uF" H 6200 1650 40  0000 L CNN
F 2 "" H 6250 1600 30  0000 C CNN
F 3 "" H 6150 1750 300 0000 C CNN
	1    6150 1750
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D32D0D
P 10050 1700
F 0 "#PWR?" H 10050 1700 30  0001 C CNN
F 1 "GND" H 10050 1630 30  0001 C CNN
F 2 "" H 10050 1700 60  0000 C CNN
F 3 "" H 10050 1700 60  0000 C CNN
	1    10050 1700
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D32D54
P 3100 4500
F 0 "#PWR?" H 3100 4500 30  0001 C CNN
F 1 "GND" H 3100 4430 30  0001 C CNN
F 2 "" H 3100 4500 60  0000 C CNN
F 3 "" H 3100 4500 60  0000 C CNN
	1    3100 4500
	1    0    0    -1  
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D32E6B
P 3100 2400
F 0 "#PWR?" H 3100 2500 30  0001 C CNN
F 1 "VDD" H 3100 2510 30  0000 C CNN
F 2 "" H 3100 2400 60  0000 C CNN
F 3 "" H 3100 2400 60  0000 C CNN
	1    3100 2400
	1    0    0    -1  
$EndComp
$Comp
L C C2
U 1 1 53D32ECC
P 5350 1750
F 0 "C2" H 5350 1850 40  0000 L CNN
F 1 "0.1uF" H 5356 1665 40  0000 L CNN
F 2 "" H 5388 1600 30  0000 C CNN
F 3 "" H 5350 1750 60  0000 C CNN
	1    5350 1750
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D32F27
P 5350 1950
F 0 "#PWR?" H 5350 1950 30  0001 C CNN
F 1 "GND" H 5350 1880 30  0001 C CNN
F 2 "" H 5350 1950 60  0000 C CNN
F 3 "" H 5350 1950 60  0000 C CNN
	1    5350 1950
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D32F3B
P 6150 1950
F 0 "#PWR?" H 6150 1950 30  0001 C CNN
F 1 "GND" H 6150 1880 30  0001 C CNN
F 2 "" H 6150 1950 60  0000 C CNN
F 3 "" H 6150 1950 60  0000 C CNN
	1    6150 1950
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D33037
P 4550 2150
F 0 "#PWR?" H 4550 2150 30  0001 C CNN
F 1 "GND" H 4550 2080 30  0001 C CNN
F 2 "" H 4550 2150 60  0000 C CNN
F 3 "" H 4550 2150 60  0000 C CNN
	1    4550 2150
	1    0    0    -1  
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D3304B
P 4550 1450
F 0 "#PWR?" H 4550 1550 30  0001 C CNN
F 1 "VDD" H 4550 1560 30  0000 C CNN
F 2 "" H 4550 1450 60  0000 C CNN
F 3 "" H 4550 1450 60  0000 C CNN
	1    4550 1450
	-1   0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D3318A
P 6750 3400
F 0 "#PWR?" H 6750 3400 30  0001 C CNN
F 1 "GND" H 6750 3330 30  0001 C CNN
F 2 "" H 6750 3400 60  0000 C CNN
F 3 "" H 6750 3400 60  0000 C CNN
	1    6750 3400
	0    1    -1   0   
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D3319C
P 6750 2500
F 0 "#PWR?" H 6750 2600 30  0001 C CNN
F 1 "VDD" H 6750 2610 30  0000 C CNN
F 2 "" H 6750 2500 60  0000 C CNN
F 3 "" H 6750 2500 60  0000 C CNN
	1    6750 2500
	0    -1   -1   0   
$EndComp
$Comp
L GND #PWR?
U 1 1 53D331C5
P 9650 3400
F 0 "#PWR?" H 9650 3400 30  0001 C CNN
F 1 "GND" H 9650 3330 30  0001 C CNN
F 2 "" H 9650 3400 60  0000 C CNN
F 3 "" H 9650 3400 60  0000 C CNN
	1    9650 3400
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D331D9
P 8850 3100
F 0 "#PWR?" H 8850 3100 30  0001 C CNN
F 1 "GND" H 8850 3030 30  0001 C CNN
F 2 "" H 8850 3100 60  0000 C CNN
F 3 "" H 8850 3100 60  0000 C CNN
	1    8850 3100
	0    -1   -1   0   
$EndComp
$Comp
L TPS77033 U3
U 1 1 53D3518C
P 6600 1450
F 0 "U3" H 6750 1054 60  0000 C CNN
F 1 "TPS77033" H 6600 1650 60  0000 C CNN
F 2 "" H 6600 1450 60  0000 C CNN
F 3 "" H 6600 1450 60  0000 C CNN
	1    6600 1450
	-1   0    0    -1  
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D354DD
P 5100 1550
F 0 "#PWR?" H 5100 1650 30  0001 C CNN
F 1 "VDD" H 5100 1660 30  0000 C CNN
F 2 "" H 5100 1550 60  0000 C CNN
F 3 "" H 5100 1550 60  0000 C CNN
	1    5100 1550
	0    -1   -1   0   
$EndComp
$Comp
L GND #PWR?
U 1 1 53D354FE
P 6600 1900
F 0 "#PWR?" H 6600 1900 30  0001 C CNN
F 1 "GND" H 6600 1830 30  0001 C CNN
F 2 "" H 6600 1900 60  0000 C CNN
F 3 "" H 6600 1900 60  0000 C CNN
	1    6600 1900
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D35512
P 6900 1650
F 0 "#PWR?" H 6900 1650 30  0001 C CNN
F 1 "GND" H 6900 1580 30  0001 C CNN
F 2 "" H 6900 1650 60  0000 C CNN
F 3 "" H 6900 1650 60  0000 C CNN
	1    6900 1650
	0    -1   -1   0   
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D35928
P 6800 4650
F 0 "#PWR?" H 6800 4750 30  0001 C CNN
F 1 "VDD" H 6800 4760 30  0000 C CNN
F 2 "" H 6800 4650 60  0000 C CNN
F 3 "" H 6800 4650 60  0000 C CNN
	1    6800 4650
	0    -1   -1   0   
$EndComp
$Comp
L GND #PWR?
U 1 1 53D35933
P 6800 5050
F 0 "#PWR?" H 6800 5050 30  0001 C CNN
F 1 "GND" H 6800 4980 30  0001 C CNN
F 2 "" H 6800 5050 60  0000 C CNN
F 3 "" H 6800 5050 60  0000 C CNN
	1    6800 5050
	0    1    -1   0   
$EndComp
$Comp
L LM358 U2
U 1 1 53D35B75
P 3950 5600
F 0 "U2" H 3900 5800 60  0000 L CNN
F 1 "LM358" H 3900 5350 60  0000 L CNN
F 2 "" H 3950 5600 60  0000 C CNN
F 3 "" H 3950 5600 60  0000 C CNN
	1    3950 5600
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D35BB6
P 3850 6000
F 0 "#PWR?" H 3850 6000 30  0001 C CNN
F 1 "GND" H 3850 5930 30  0001 C CNN
F 2 "" H 3850 6000 60  0000 C CNN
F 3 "" H 3850 6000 60  0000 C CNN
	1    3850 6000
	1    0    0    -1  
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D35BCA
P 3850 5200
F 0 "#PWR?" H 3850 5300 30  0001 C CNN
F 1 "VDD" H 3850 5310 30  0000 C CNN
F 2 "" H 3850 5200 60  0000 C CNN
F 3 "" H 3850 5200 60  0000 C CNN
	1    3850 5200
	1    0    0    -1  
$EndComp
$Comp
L R R4
U 1 1 53D35C10
P 3150 6550
F 0 "R4" V 3230 6550 40  0000 C CNN
F 1 "22K" V 3157 6551 40  0000 C CNN
F 2 "" V 3080 6550 30  0000 C CNN
F 3 "" H 3150 6550 30  0000 C CNN
	1    3150 6550
	1    0    0    -1  
$EndComp
$Comp
L R R5
U 1 1 53D35C63
P 3800 6300
F 0 "R5" V 3880 6300 40  0000 C CNN
F 1 "1M" V 3807 6301 40  0000 C CNN
F 2 "" V 3730 6300 30  0000 C CNN
F 3 "" H 3800 6300 30  0000 C CNN
	1    3800 6300
	0    -1   -1   0   
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D35DDC
P 3150 5000
F 0 "#PWR?" H 3150 5100 30  0001 C CNN
F 1 "VDD" H 3150 5110 30  0000 C CNN
F 2 "" H 3150 5000 60  0000 C CNN
F 3 "" H 3150 5000 60  0000 C CNN
	1    3150 5000
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D35DF0
P 3150 6800
F 0 "#PWR?" H 3150 6800 30  0001 C CNN
F 1 "GND" H 3150 6730 30  0001 C CNN
F 2 "" H 3150 6800 60  0000 C CNN
F 3 "" H 3150 6800 60  0000 C CNN
	1    3150 6800
	1    0    0    -1  
$EndComp
$Comp
L NPN Q2
U 1 1 53D35E04
P 2500 6600
F 0 "Q2" H 2500 6450 50  0000 R CNN
F 1 "S9014" H 2950 6600 50  0000 R CNN
F 2 "" H 2500 6600 60  0000 C CNN
F 3 "" H 2500 6600 60  0000 C CNN
	1    2500 6600
	1    0    0    -1  
$EndComp
$Comp
L OPTO_NPN Q1
U 1 1 53D35EC7
P 2200 5900
F 0 "Q1" H 2350 5950 50  0000 L CNN
F 1 "S1133" H 2350 5800 50  0000 L CNN
F 2 "" H 2200 5900 60  0000 C CNN
F 3 "" H 2200 5900 60  0000 C CNN
	1    2200 5900
	1    0    0    -1  
$EndComp
$Comp
L R R2
U 1 1 53D35F1D
P 2300 5250
F 0 "R2" V 2380 5250 40  0000 C CNN
F 1 "100K" V 2307 5251 40  0000 C CNN
F 2 "" V 2230 5250 30  0000 C CNN
F 3 "" H 2300 5250 30  0000 C CNN
	1    2300 5250
	1    0    0    -1  
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D35F3F
P 2300 5000
F 0 "#PWR?" H 2300 5100 30  0001 C CNN
F 1 "VDD" H 2300 5110 30  0000 C CNN
F 2 "" H 2300 5000 60  0000 C CNN
F 3 "" H 2300 5000 60  0000 C CNN
	1    2300 5000
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D35FD0
P 2600 6800
F 0 "#PWR?" H 2600 6800 30  0001 C CNN
F 1 "GND" H 2600 6730 30  0001 C CNN
F 2 "" H 2600 6800 60  0000 C CNN
F 3 "" H 2600 6800 60  0000 C CNN
	1    2600 6800
	1    0    0    -1  
$EndComp
$Comp
L CONN_6 P1
U 1 1 53D36642
P 5150 5150
F 0 "P1" V 5100 5150 60  0000 C CNN
F 1 "Program" V 5200 5150 60  0000 C CNN
F 2 "" H 5150 5150 60  0000 C CNN
F 3 "" H 5150 5150 60  0000 C CNN
	1    5150 5150
	0    1    1    0   
$EndComp
$Comp
L VDD #PWR?
U 1 1 53D367FD
P 4900 4800
F 0 "#PWR?" H 4900 4900 30  0001 C CNN
F 1 "VDD" H 4900 4910 30  0000 C CNN
F 2 "" H 4900 4800 60  0000 C CNN
F 3 "" H 4900 4800 60  0000 C CNN
	1    4900 4800
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D36803
P 5400 4800
F 0 "#PWR?" H 5400 4800 30  0001 C CNN
F 1 "GND" H 5400 4730 30  0001 C CNN
F 2 "" H 5400 4800 60  0000 C CNN
F 3 "" H 5400 4800 60  0000 C CNN
	1    5400 4800
	1    0    0    1   
$EndComp
$Comp
L C C4
U 1 1 53D36D73
P 7300 1600
F 0 "C4" H 7300 1700 40  0000 L CNN
F 1 "0.47uF" H 7306 1515 40  0000 L CNN
F 2 "" H 7338 1450 30  0000 C CNN
F 3 "" H 7300 1600 60  0000 C CNN
	1    7300 1600
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D36D79
P 7300 1800
F 0 "#PWR?" H 7300 1800 30  0001 C CNN
F 1 "GND" H 7300 1730 30  0001 C CNN
F 2 "" H 7300 1800 60  0000 C CNN
F 3 "" H 7300 1800 60  0000 C CNN
	1    7300 1800
	1    0    0    -1  
$EndComp
$Comp
L CONN_5X2 P2
U 1 1 53D44116
P 7200 4850
F 0 "P2" H 7200 5150 60  0000 C CNN
F 1 "XBee Adaptor" V 7200 4850 50  0000 C CNN
F 2 "" H 7200 4850 60  0000 C CNN
F 3 "" H 7200 4850 60  0000 C CNN
	1    7200 4850
	1    0    0    -1  
$EndComp
Text Notes 7550 3750 0    60   ~ 0
On/Sleep
Text Notes 7200 4050 0    60   ~ 0
Battery Measurement Control
Text Notes 5100 2250 0    60   ~ 0
Microcontroller Reset
Text Notes 5100 2900 0    60   ~ 0
XBee Reset
Text Notes 5150 3000 0    60   ~ 0
Sleep Rq
Text Notes 5150 3100 0    60   ~ 0
Bootloader
Text Notes 5450 3600 0    60   ~ 0
Rx
Text Notes 5450 3700 0    60   ~ 0
Tx
Wire Wire Line
	9650 1400 9650 2000
Wire Wire Line
	10050 1600 10050 1700
Wire Wire Line
	6900 1400 10050 1400
Wire Wire Line
	1750 1950 4550 1950
Wire Wire Line
	1750 1950 1750 2700
Wire Wire Line
	9650 2500 8850 2500
Wire Wire Line
	4450 3600 6100 3600
Wire Wire Line
	6100 2600 6100 4750
Wire Wire Line
	6100 2600 6750 2600
Wire Wire Line
	4450 3700 6200 3700
Wire Wire Line
	6200 2700 6200 4850
Wire Wire Line
	6200 2700 6750 2700
Wire Wire Line
	4450 4100 9350 4100
Wire Wire Line
	9350 4100 9350 2700
Wire Wire Line
	4450 3100 6750 3100
Wire Wire Line
	6750 2900 4450 2900
Wire Wire Line
	6750 2800 6000 2800
Wire Wire Line
	6000 2800 6000 2300
Wire Wire Line
	6000 2300 4250 2300
Wire Wire Line
	4250 2300 4250 1950
Connection ~ 4250 1950
Wire Wire Line
	6000 3300 6750 3300
Wire Wire Line
	6000 3300 6000 3000
Wire Wire Line
	6000 3000 4450 3000
Wire Wire Line
	8850 3200 9150 3200
Wire Wire Line
	9150 3200 9150 4850
Wire Wire Line
	9150 3800 5900 3800
Wire Wire Line
	5900 3800 5900 2800
Wire Wire Line
	5900 2800 4450 2800
Wire Wire Line
	6100 4750 6800 4750
Connection ~ 6100 3600
Wire Wire Line
	6200 4850 6800 4850
Connection ~ 6200 3700
Wire Wire Line
	6300 3100 6300 4950
Wire Wire Line
	6300 4950 6800 4950
Connection ~ 6300 3100
Wire Wire Line
	6400 3300 6400 4350
Connection ~ 6400 3300
Wire Wire Line
	9150 4850 7600 4850
Connection ~ 9150 3800
Wire Wire Line
	8850 3300 9050 3300
Wire Wire Line
	9050 3300 9050 4750
Wire Wire Line
	8850 2900 9250 2900
Wire Wire Line
	9250 2900 9250 4950
Wire Wire Line
	9250 4950 7600 4950
Wire Wire Line
	4450 3800 4650 3800
Wire Wire Line
	4650 3800 4650 5600
Wire Wire Line
	4650 5600 4450 5600
Wire Wire Line
	4450 5600 4450 6300
Wire Wire Line
	4450 6300 4050 6300
Wire Wire Line
	3550 6300 3150 6300
Wire Wire Line
	3450 5500 3150 5500
Wire Wire Line
	3150 5500 3150 6300
Wire Wire Line
	2300 5700 3450 5700
Wire Wire Line
	2600 5700 2600 6400
Wire Wire Line
	2300 6100 2300 6600
Connection ~ 2600 5700
Wire Wire Line
	2300 5500 2300 5700
Wire Wire Line
	5100 1550 6300 1550
Wire Wire Line
	4450 3200 5300 3200
Wire Wire Line
	5300 3200 5300 4800
Wire Wire Line
	4450 3300 5200 3300
Wire Wire Line
	5200 3300 5200 4800
Wire Wire Line
	4450 3400 5100 3400
Wire Wire Line
	5100 3400 5100 4800
Wire Wire Line
	5000 4800 5000 2300
Connection ~ 5000 2300
Wire Wire Line
	6400 4350 7600 4350
Wire Wire Line
	7600 4350 7600 4650
Wire Wire Line
	9050 4750 7600 4750
Connection ~ 9650 1400
$Comp
L CONN_2 P3
U 1 1 53D4FA83
P 10400 1000
F 0 "P3" V 10350 1000 40  0000 C CNN
F 1 "Led" V 10450 1000 40  0000 C CNN
F 2 "" H 10400 1000 60  0000 C CNN
F 3 "" H 10400 1000 60  0000 C CNN
	1    10400 1000
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR?
U 1 1 53D4FA89
P 10050 1200
F 0 "#PWR?" H 10050 1200 30  0001 C CNN
F 1 "GND" H 10050 1130 30  0001 C CNN
F 2 "" H 10050 1200 60  0000 C CNN
F 3 "" H 10050 1200 60  0000 C CNN
	1    10050 1200
	1    0    0    -1  
$EndComp
Wire Wire Line
	10050 1100 10050 1200
Wire Wire Line
	10050 900  9500 900 
Connection ~ 9500 1400
$Comp
L R R1
U 1 1 53D4FCA0
P 9500 1150
F 0 "R1" V 9580 1150 40  0000 C CNN
F 1 "33K" V 9507 1151 40  0000 C CNN
F 2 "" V 9430 1150 30  0000 C CNN
F 3 "" H 9500 1150 30  0000 C CNN
	1    9500 1150
	1    0    0    -1  
$EndComp
$EndSCHEMATC
